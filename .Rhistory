tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('nosemajguod', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('lebrasajames', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('brial22', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('aaronstank', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('benbbaldwin ', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('brial22', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('aaronstank', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('benbbaldwin', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('brial22', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('aaronstank', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('brial22', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('brial22', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('simplynader', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('aaronstank', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('benbbaldwin', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:5)
get_favorites('gblanco121', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets gblanco121 liked') %>%
slice(1:5)
get_favorites('MCSUDABUDA', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets MCSUDABUDA liked') %>%
slice(1:5)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:5)
get_favorites('brial22', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets brial22 liked') %>%
slice(1:10)
get_favorites('brial22', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets brial22 liked') %>%
slice(1:10)
get_favorites('brial22', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets brial22 liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('walexbelsh', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets walexbelsh liked') %>%
slice(1:10)
get_favorites('brial22', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets brial22 liked') %>%
slice(1:10)
get_favorites('fakeColinW', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets I liked') %>%
slice(1:10)
get_favorites('ChartingHockey', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets ChartingHockey liked') %>%
slice(1:10)
get_favorites('IneffectiveMath', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets IneffectiveMath liked') %>%
slice(1:10)
library(tidyverse)
library(rtweet)
get_favorites('simplynader', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets simplynader liked') %>%
slice(1:10)
get_favorites('gblanco121', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets gblanco121 liked') %>%
slice(1:10)
library(tidyverse)
library(rtweet)
get_favorites('nosemajguod', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets nosemajguod' liked') %>%
slice(1:10)
get_favorites('nosemajguod', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets nosemajguod' liked') %>%
slice(1:10)
get_favorites('nosemajguod', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets nosemajguod' liked') %>%
slice(1:10)
get_favorites('nosemajguod', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets nosemajguod liked') %>%
slice(1:10)
library(tidyverse)
library(rtweet)
get_favorites('JaredL_Phillips', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets JaredL_Phillips liked') %>%
slice(1:10)
get_favorites('DJSteveJones', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets DJSteveJones liked') %>%
slice(1:10)
get_favorites('BenMcWilliams22', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets BenMcWilliams22 liked') %>%
slice(1:10)
get_favorites('temerrick', n=3000) %>%
group_by('@' = screen_name) %>%
tally(sort=TRUE, name='# of tweets temerrick liked') %>%
slice(1:10)
##install.packages(c("devtools", "tidyverse", "readr", "pander", "na.tools", "ggimage", "devtools", "teamcolors", "glue", "animate", "dplyr"))
##devtools::install_github(repo = "maksimhorowitz/nflscrapR")
library(nflscrapR)
library(tidyverse)
library(readr)
library(pander)
library(dplyr)
library(na.tools)
library(ggimage)
library(teamcolors)
library(plyr)
library(readr)
library(glue)
library(animate)
##reset
setwd("~/")
gid <- paste(getwd())
gid
device <- ""
if (gid == "/Volumes/HDD/Users/colinwelsh") {
##Maverick - MBP
setwd("~/Documents/dev/football")
device <- "Maverick (MBP)"
} else if (gid == "/Users/ColinWelsh") {
##Goose - iMac
setwd("~/Documents/dev/football")
device <- "Goose (iMac)"
##add Goose
}
print(paste(device, "is ready for some football", sep = " "))
rm(gid, device)
# other dependent variables
userYear <- 2019 ##necessary for saved
userWeek <- 11 ##not necessary at the moment
fgame_ids <- paste("data/games/reg_season/reg_games_", userYear, ".csv", sep ="")
install.packages(c("BiocManager", "digest", "DT", "knitr", "R6", "rlang", "rmarkdown", "roxygen2", "scales", "selectr", "tidyverse", "xfun"))
install.packages(c("boot", "foreign", "KernSmooth", "mgcv", "nlme", "survival"), lib="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
##install.packages(c("devtools", "tidyverse", "readr", "pander", "na.tools", "ggimage", "devtools", "teamcolors", "glue", "animate", "dplyr"))
##devtools::install_github(repo = "maksimhorowitz/nflscrapR")
library(nflscrapR)
library(tidyverse)
library(readr)
library(pander)
library(dplyr)
library(na.tools)
library(ggimage)
library(teamcolors)
library(plyr)
library(readr)
library(glue)
library(animate)
##reset
setwd("~/")
gid <- paste(getwd())
gid
device <- ""
if (gid == "/Volumes/HDD/Users/colinwelsh") {
##Maverick - MBP
setwd("~/Documents/dev/football")
device <- "Maverick (MBP)"
} else if (gid == "/Users/ColinWelsh") {
##Goose - iMac
setwd("~/Documents/dev/football")
device <- "Goose (iMac)"
##add Goose
}
print(paste(device, "is ready for some football", sep = " "))
rm(gid, device)
# other dependent variables
userYear <- 2019 ##necessary for saved
userWeek <- 11 ##not necessary at the moment
fgame_ids <- paste("data/games/reg_season/reg_games_", userYear, ".csv", sep ="")
y <- data.frame()
# set custom variables
userYear <- 2019 ##necessary for saved
userWeek <- 12 ##not necessary at the moment
today <- Sys.Date()
# test date
date <- 2019112
##  date <- format(today, format="%Y%m%d")
fgame_ids <- paste("data/games/reg_season/reg_games_", userYear, ".csv", sep ="")
## read Game IDs
game_ids <- read.csv(fgame_ids, check.names = FALSE)
## save Game IDs
# write.csv(game_ids, file = fgame_ids, row.names = FALSE)
y <- data.frame()
currentGameIDs <- game_ids$game_id
#pull games in 2019 season that match today's date
currentGames <- grep(date, currentGameIDs)
games_in_play <- currentGameIDs[currentGames]
##can't figure this out yet
#
#  games_in_play <- game_ids$state_of_game[currentGames] != "POST"
#
#  nplay <- length(games_in_play)
#  nplayLoop <- 1
#
# scrape pbp of active games
# if 0 games, scrape scores
for (x in games_in_play)
{
f <- paste("data/games/", userYear, "/", x, ".csv", sep = "")
fplayers <-  paste("data/players/", userYear, "/", x, "players", ".csv", sep = "")
if (file.exists(fplayers)==TRUE & grepl("END GAME", y$desc[nrow(y)]) == TRUE)
{
xplayers <- player_game(x)
write.csv(xplayers, fplayers, row.names = FALSE)
} else {
xplayers <- player_game(x)
write.csv(xplayers, fplayers, row.names = FALSE)
}
if (file.exists(f)==TRUE)
{
#read game csv
y <- read.csv(f, check.names=FALSE)
tail(y)
#check if y$desc contains "END GAME"
#if x has END GAME change state_of_game to POST
if (grepl("END GAME", y$desc[nrow(y)]) == TRUE)
{
print(paste("Game", x, "is over.", sep = " "))
game_ids[game_ids$game_id == x, "state_of_game"] <- "POST"
game_ids[game_ids$game_id == x, "away_score"] <- y$total_away_score[nrow(y)]
game_ids[game_ids$game_id == x, "home_score"] <- y$total_home_score[nrow(y)]
print(paste("Changing the state of game for", x, "to POST", sep = " "))
write.csv(game_ids, fgame_ids, row.names = FALSE)
}
else
{
#scrape
print(paste("Scraping game ", x, sep = ""))
print(paste(game_ids[game_ids$game_id == x, "away_team"], "vs", game_ids[game_ids$game_id == x, "home_team"], sep = " "))
y <- scrape_json_play_by_play(x)
tail(y)
game_ids$X <- NULL ## annoying glitch
if (grepl("END GAME", y$desc[nrow(y)]) == TRUE) {
print(paste("Game", x, "is over.", sep = " "))
print(paste(game_ids[game_ids$game_id == x, "away_team"], "vs", game_ids[game_ids$game_id == x, "home_team"], sep = " "))
game_ids[game_ids$game_id == x, "state_of_game"] <- "POST"
game_ids[game_ids$game_id == x, "away_score"] <- y$total_away_score[nrow(y)]
game_ids[game_ids$game_id == x, "home_score"] <- y$total_home_score[nrow(y)]
print(paste("Changing the state of game for ", x, " to POST", sep = ""))
write.csv(game_ids, fgame_ids, row.names=FALSE)
}
write.csv(y, file = paste("data/games/", userYear,"/", x, ".csv", sep = ""), row.names=FALSE)
}
}
else
{
print(paste("Scraping game", x, sep = " "))
print(
paste(
game_ids[
game_ids$game_id == x, "away_team"],
"vs",
game_ids[game_ids$game_id == x, "home_team"],
sep = " "
)
)
y <- scrape_json_play_by_play(x)
tail(y)
write.csv(y, file = paste("data/games/", userYear,"/", x, ".csv", sep = ""), row.names=FALSE)
}
xawayscore <- y$total_away_score[nrow(y)]
xawayteam <- y$away_team[1]
xhomescore <- y$total_home_score[nrow(y)]
xhometeam <- y$home_team[1]
print(paste(xawayteam, ": ", xawayscore, " @ ", xhometeam, ": ", xhomescore, sep = ""))
print(paste("Last play:", y$desc[nrow(y)], sep=""))
}
for (x in games_in_play)
{
f <- paste("data/games/", userYear, "/", x, ".csv", sep = "")
fplayers <-  paste("data/players/", userYear, "/", x, "players", ".csv", sep = "")
if (file.exists(f)==TRUE)
{
#read game csv
y <- read.csv(f, check.names=FALSE)
tail(y)
#check if y$desc contains "END GAME"
#if x has END GAME change state_of_game to POST
if (grepl("END GAME", y$desc[nrow(y)]) == TRUE)
{
print(paste("Game", x, "is over.", sep = " "))
game_ids[game_ids$game_id == x, "state_of_game"] <- "POST"
game_ids[game_ids$game_id == x, "away_score"] <- y$total_away_score[nrow(y)]
game_ids[game_ids$game_id == x, "home_score"] <- y$total_home_score[nrow(y)]
print(paste("Changing the state of game for", x, "to POST", sep = " "))
write.csv(game_ids, fgame_ids, row.names = FALSE)
}
else
{
#scrape
print(paste("Scraping game ", x, sep = ""))
print(paste(game_ids[game_ids$game_id == x, "away_team"], "vs", game_ids[game_ids$game_id == x, "home_team"], sep = " "))
y <- scrape_json_play_by_play(x)
tail(y)
game_ids$X <- NULL ## annoying glitch
if (grepl("END GAME", y$desc[nrow(y)]) == TRUE) {
print(paste("Game", x, "is over.", sep = " "))
print(paste(game_ids[game_ids$game_id == x, "away_team"], "vs", game_ids[game_ids$game_id == x, "home_team"], sep = " "))
game_ids[game_ids$game_id == x, "state_of_game"] <- "POST"
game_ids[game_ids$game_id == x, "away_score"] <- y$total_away_score[nrow(y)]
game_ids[game_ids$game_id == x, "home_score"] <- y$total_home_score[nrow(y)]
print(paste("Changing the state of game for ", x, " to POST", sep = ""))
write.csv(game_ids, fgame_ids, row.names=FALSE)
}
write.csv(y, file = paste("data/games/", userYear,"/", x, ".csv", sep = ""), row.names=FALSE)
}
}
else
{
print(paste("Scraping game", x, sep = " "))
print(
paste(
game_ids[
game_ids$game_id == x, "away_team"],
"vs",
game_ids[game_ids$game_id == x, "home_team"],
sep = " "
)
)
y <- scrape_json_play_by_play(x)
tail(y)
write.csv(y, file = paste("data/games/", userYear,"/", x, ".csv", sep = ""), row.names=FALSE)
}
xawayscore <- y$total_away_score[nrow(y)]
xawayteam <- y$away_team[1]
xhomescore <- y$total_home_score[nrow(y)]
xhometeam <- y$home_team[1]
print(paste(xawayteam, ": ", xawayscore, " @ ", xhometeam, ": ", xhomescore, sep = ""))
print(paste("Last play:", y$desc[nrow(y)], sep=""))
}
for (x in games_in_play)
{
f <- paste("data/games/", userYear, "/", x, ".csv", sep = "")
fplayers <-  paste("data/players/", userYear, "/", x, "players", ".csv", sep = "")
if (file.exists(fplayers)==TRUE & grepl("END GAME", y$desc[nrow(y)]) == TRUE)
{
xplayers <- player_game(x)
write.csv(xplayers, fplayers, row.names = FALSE)
} else {
xplayers <- player_game(x)
write.csv(xplayers, fplayers, row.names = FALSE)
}
if (file.exists(f)==TRUE)
{
#read game csv
y <- read.csv(f, check.names=FALSE)
tail(y)
#check if y$desc contains "END GAME"
#if x has END GAME change state_of_game to POST
if (grepl("END GAME", y$desc[nrow(y)]) == TRUE)
{
print(paste("Game", x, "is over.", sep = " "))
game_ids[game_ids$game_id == x, "state_of_game"] <- "POST"
game_ids[game_ids$game_id == x, "away_score"] <- y$total_away_score[nrow(y)]
game_ids[game_ids$game_id == x, "home_score"] <- y$total_home_score[nrow(y)]
print(paste("Changing the state of game for", x, "to POST", sep = " "))
write.csv(game_ids, fgame_ids, row.names = FALSE)
}
else
{
#scrape
print(paste("Scraping game ", x, sep = ""))
print(paste(game_ids[game_ids$game_id == x, "away_team"], "vs", game_ids[game_ids$game_id == x, "home_team"], sep = " "))
y <- scrape_json_play_by_play(x)
tail(y)
game_ids$X <- NULL ## annoying glitch
if (grepl("END GAME", y$desc[nrow(y)]) == TRUE) {
print(paste("Game", x, "is over.", sep = " "))
print(paste(game_ids[game_ids$game_id == x, "away_team"], "vs", game_ids[game_ids$game_id == x, "home_team"], sep = " "))
game_ids[game_ids$game_id == x, "state_of_game"] <- "POST"
game_ids[game_ids$game_id == x, "away_score"] <- y$total_away_score[nrow(y)]
game_ids[game_ids$game_id == x, "home_score"] <- y$total_home_score[nrow(y)]
print(paste("Changing the state of game for ", x, " to POST", sep = ""))
write.csv(game_ids, fgame_ids, row.names=FALSE)
}
write.csv(y, file = paste("data/games/", userYear,"/", x, ".csv", sep = ""), row.names=FALSE)
}
}
else
{
print(paste("Scraping game", x, sep = " "))
print(
paste(
game_ids[
game_ids$game_id == x, "away_team"],
"vs",
game_ids[game_ids$game_id == x, "home_team"],
sep = " "
)
)
y <- scrape_json_play_by_play(x)
tail(y)
write.csv(y, file = paste("data/games/", userYear,"/", x, ".csv", sep = ""), row.names=FALSE)
}
xawayscore <- y$total_away_score[nrow(y)]
xawayteam <- y$away_team[1]
xhomescore <- y$total_home_score[nrow(y)]
xhometeam <- y$home_team[1]
print(paste(xawayteam, ": ", xawayscore, " @ ", xhometeam, ": ", xhomescore, sep = ""))
print(paste("Last play:", y$desc[nrow(y)], sep=""))
}
