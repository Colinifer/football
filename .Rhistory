subtitle = paste("Minimum", gg.recyds_minimum, "receiving yards", sep = " ")) +
xlab("Receivers") +
ylab("Receiving Yards")
################
## Passing Yards descending
################
passyds_plot <- ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -passyds, Team), y=passyds,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 passing yards by team",
subtitle = paste("Minimum", gg.passyds_minimum, "passing yards", sep = " ")) +
xlab("Passers") +
ylab("Passing Yards")
################
## Passing Yards descending
################
pass.att_plot <- ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -pass.att, Team), y=pass.att,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 passing attempts by team",
subtitle = paste("Minimum", gg.pass.att_minimum, "passing attempts", sep = " ")) +
xlab("Passers") +
ylab("Passing Attempts")
################
## Facets by screen
###############
mobile_facet <-
facet_wrap( ~ Team, ncol = 32/8, scales = "free_x")
desktop_facet <-
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x")
###############
## Save Functions
###############
targetsplot_mobile <- gg.targets %>% targets_plot + mobile_facet
targetsplot_desktop <- gg.targets %>% targets_plot + desktop_facet
recydsplot_mobile <- gg.recyds %>% recyds_plot + mobile_facet
recydsplot_desktop <- gg.recyds %>% recyds_plot + desktop_facet
targetsplot_mobile <- gg.targets %>% targets_plot + mobile_facet
targetsplot_desktop <- gg.targets %>% targets_plot + desktop_facet
passyds_plot_desktop_mobile <- gg.passyds %>% passyds_plot
pass.att_plot_desktop_mobile <- gg.pass.att %>% pass.att_plot
targetsplot_mobile <- ggplot(gg.targets %>% targets_plot + mobile_facet)
gg.pass.att %>% pass.att_plot
gg.passyds %>% passyds_plot
passyds_plot <- gg.passyds %>% ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -passyds, Team), y=passyds,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 passing yards by team",
subtitle = paste("Minimum", gg.passyds_minimum, "passing yards", sep = " ")) +
xlab("Passers") +
ylab("Passing Yards")
passyds_plot <- gg.passyds %>% ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -passyds, Team), y=passyds,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 passing yards by team",
subtitle = paste("Minimum", gg.passyds_minimum, "passing yards", sep = " ")) +
xlab("Passers") +
ylab("Passing Yards")
gg.passyds %>% ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -passyds, Team), y=passyds,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 passing yards by team",
subtitle = paste("Minimum", gg.passyds_minimum, "passing yards", sep = " ")) +
xlab("Passers") +
ylab("Passing Yards")
gg.targets %>% ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team), stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets")
gg.targets %>% ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team), stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets") +
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x")
targets_plot <- gg.targets %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets")
targets_plot + mobile_facet
targetsplot_mobile <- targets_plot + mobile_facet
targetsplot_desktop <- targets_plot + desktop_facet
recydsplot_mobile <- recyds_plot + mobile_facet
recydsplot_desktop <-recyds_plot + desktop_facet
targetsplot_mobile <- targets_plot + mobile_facet
targetsplot_desktop <- targets_plot + desktop_facet
passyds_plot_desktop_mobile <- passyds_plot
pass.att_plot_desktop_mobile <- gpass.att_plot
pass.att_plot_desktop_mobile <- pass.att_plot
"plots/mobile/passyds_1440mobile.png" %>% ggsave(passyds_plot_desktop_mobile, width = 14, height = 18, dpi = 100, limitsize = FALSE)
"plots/mobile/passyds_1080mobile.png" %>% ggsave(passyds_plot_desktop_mobile, width = 10, height = 14, dpi = 100, limitsize = FALSE)
"plots/desktop/passyds_1080desktop.png" %>% ggsave(passyds_plot_desktop_mobile, width = 14, height = 10, dpi = 100, limitsize = FALSE)
"plots/mobile/pass.att_1440mobile.png" %>% ggsave(pass.att_plot_desktop_mobile, width = 14, height = 18, dpi = 100, limitsize = FALSE)
"plots/mobile/pass.att_1080mobile.png" %>% ggsave(pass.att_plot_desktop_mobile, width = 10, height = 14, dpi = 100, limitsize = FALSE)
"plots/desktop/pass.att_1080desktop.png" %>% ggsave(pass.att_plot_desktop_mobile, width = 14, height = 10, dpi = 100, limitsize = FALSE)
gg.targets %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team), stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets")
gg.targets_minimum <- 20
gg.targets <- x.players %>%
filter(targets > gg.targets_minimum) %>%  ## What is the minimum receiving yards for the sample?
arrange(desc(targets)) %>%
arrange(Team)
gg.recyds_minimum <- 250
gg.recyds <- x.players %>%
filter(recyds > gg.recyds_minimum) %>%  ## What is the minimum receiving yards for the sample?
arrange(desc(recyds)) %>%
arrange(Team)
gg.passyds_minimum <- 400
gg.passyds <- x.players %>%
filter(passyds > gg.passyds_minimum) %>%  ## What is the minimum receiving yards for the sample?
arrange(desc(passyds)) %>%
arrange(Team)
gg.pass.att_minimum <- 100
gg.pass.att <- x.players %>%
filter(pass.att > gg.pass.att_minimum) %>%  ## What is the minimum receiving yards for the sample?
arrange(desc(pass.att)) %>%
arrange(Team)
################
## NFL colors plot
################
nfl_plot <-  ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5))
################
## Targets descending
################
targets_plot <- gg.targets %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team), stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets")
################
## Receiving Yards descending
################
recyds_plot <- gg.recyds %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -recyds, Team), y=recyds,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 receiving yards by team",
subtitle = paste("Minimum", gg.recyds_minimum, "receiving yards", sep = " ")) +
xlab("Receivers") +
ylab("Receiving Yards")
################
## Passing Yards descending
################
passyds_plot <- gg.passyds %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -passyds, Team), y=passyds,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 passing yards by team",
subtitle = paste("Minimum", gg.passyds_minimum, "passing yards", sep = " ")) +
xlab("Passers") +
ylab("Passing Yards")
################
## Passing Yards descending
################
pass.att_plot <- gg.pass.att %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -pass.att, Team), y=pass.att,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 passing attempts by team",
subtitle = paste("Minimum", gg.pass.att_minimum, "passing attempts", sep = " ")) +
xlab("Passers") +
ylab("Passing Attempts")
################
## Facets by screen
###############
mobile_facet <-
facet_wrap( ~ Team, ncol = 32/8, scales = "free_x")
desktop_facet <-
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x")
###############
## Save Functions
###############
targetsplot_mobile <- targets_plot + mobile_facet
targetsplot_desktop <- targets_plot + desktop_facet
recydsplot_mobile <- recyds_plot + mobile_facet
recydsplot_desktop <-recyds_plot + desktop_facet
targetsplot_mobile <- targets_plot + mobile_facet
targetsplot_desktop <- targets_plot + desktop_facet
passyds_plot_desktop_mobile <- passyds_plot
pass.att_plot_desktop_mobile <- pass.att_plot
"plots/mobile/targets_1440mobile.png" %>% ggsave(targetsplot_mobile, width = 14, height = 25, dpi = 100, limitsize = FALSE)
"plots/mobile/targets_1080mobile.png" %>% ggsave(targetsplot_mobile, width = 10, height = 19, dpi = 100, limitsize = FALSE)
"plots/desktop/targets_1440desktop.png" %>% ggsave(targetsplot_desktop, width = 25, height = 14, dpi = 100, limitsize = FALSE)
"plots/desktop/targets_1080desktop.png" %>% ggsave(targetsplot_desktop, width = 19, height = 10, dpi = 100, limitsize = FALSE)
"plots/mobile/recyds_1440mobile.png" %>% ggsave(recydsplot_mobile, width = 14, height = 25, dpi = 100, limitsize = FALSE)
"plots/mobile/recyds_1080mobile.png" %>% ggsave(recydsplot_mobile, width = 10, height = 19, dpi = 100, limitsize = FALSE)
"plots/desktop/recyds_1440desktop.png" %>% ggsave(recydsplot_desktop, width = 25, height = 14, dpi = 100, limitsize = FALSE)
"plots/desktop/recyds_1080desktop.png" %>% ggsave(recydsplot_desktop, width = 19, height = 10, dpi = 100, limitsize = FALSE)
"plots/mobile/passyds_1440mobile.png" %>% ggsave(passyds_plot_desktop_mobile, width = 14, height = 18, dpi = 100, limitsize = FALSE)
"plots/mobile/passyds_1080mobile.png" %>% ggsave(passyds_plot_desktop_mobile, width = 10, height = 14, dpi = 100, limitsize = FALSE)
"plots/desktop/passyds_1080desktop.png" %>% ggsave(passyds_plot_desktop_mobile, width = 14, height = 10, dpi = 100, limitsize = FALSE)
"plots/mobile/pass.att_1440mobile.png" %>% ggsave(pass.att_plot_desktop_mobile, width = 14, height = 18, dpi = 100, limitsize = FALSE)
"plots/mobile/pass.att_1080mobile.png" %>% ggsave(pass.att_plot_desktop_mobile, width = 10, height = 14, dpi = 100, limitsize = FALSE)
"plots/desktop/pass.att_1080desktop.png" %>% ggsave(pass.att_plot_desktop_mobile, width = 14, height = 10, dpi = 100, limitsize = FALSE)
################
targets_plot <- gg.targets %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .5)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team), stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets")
################
## Receiving Yards descending
################
recyds_plot <- gg.recyds %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
geom_bar(aes(x=reorder_within(name, -recyds, Team), y=recyds,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 receiving yards by team",
subtitle = paste("Minimum", gg.recyds_minimum, "receiving yards", sep = " ")) +
xlab("Receivers") +
ylab("Receiving Yards")
################
## Passing Yards descending
################
passyds_plot <- gg.passyds %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
geom_bar(aes(x=reorder_within(name, -passyds, Team), y=passyds,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 passing yards by team",
subtitle = paste("Minimum", gg.passyds_minimum, "passing yards", sep = " ")) +
xlab("Passers") +
ylab("Passing Yards")
################
## Passing Yards descending
################
pass.att_plot <- gg.pass.att %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
geom_bar(aes(x=reorder_within(name, -pass.att, Team), y=pass.att,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 passing attempts by team",
subtitle = paste("Minimum", gg.pass.att_minimum, "passing attempts", sep = " ")) +
xlab("Passers") +
ylab("Passing Attempts")
## Facets by screen
###############
mobile_facet <-
facet_wrap( ~ Team, ncol = 32/8, scales = "free_x")
desktop_facet <-
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x")
###############
## Save Functions
###############
targetsplot_mobile <- targets_plot + mobile_facet
targetsplot_desktop <- targets_plot + desktop_facet
recydsplot_mobile <- recyds_plot + mobile_facet
recydsplot_desktop <-recyds_plot + desktop_facet
targetsplot_mobile <- targets_plot + mobile_facet
targetsplot_desktop <- targets_plot + desktop_facet
passyds_plot_desktop_mobile <- passyds_plot
pass.att_plot_desktop_mobile <- pass.att_plot
"plots/mobile/targets_1440mobile.png" %>% ggsave(targetsplot_mobile, width = 14, height = 25, dpi = 100, limitsize = FALSE)
"plots/mobile/targets_1080mobile.png" %>% ggsave(targetsplot_mobile, width = 10, height = 19, dpi = 100, limitsize = FALSE)
"plots/desktop/targets_1440desktop.png" %>% ggsave(targetsplot_desktop, width = 25, height = 14, dpi = 100, limitsize = FALSE)
"plots/desktop/targets_1080desktop.png" %>% ggsave(targetsplot_desktop, width = 19, height = 10, dpi = 100, limitsize = FALSE)
"plots/mobile/recyds_1440mobile.png" %>% ggsave(recydsplot_mobile, width = 14, height = 25, dpi = 100, limitsize = FALSE)
"plots/mobile/recyds_1080mobile.png" %>% ggsave(recydsplot_mobile, width = 10, height = 19, dpi = 100, limitsize = FALSE)
"plots/desktop/recyds_1440desktop.png" %>% ggsave(recydsplot_desktop, width = 25, height = 14, dpi = 100, limitsize = FALSE)
"plots/desktop/recyds_1080desktop.png" %>% ggsave(recydsplot_desktop, width = 19, height = 10, dpi = 100, limitsize = FALSE)
"plots/mobile/passyds_1440mobile.png" %>% ggsave(passyds_plot_desktop_mobile, width = 14, height = 18, dpi = 100, limitsize = FALSE)
"plots/mobile/passyds_1080mobile.png" %>% ggsave(passyds_plot_desktop_mobile, width = 10, height = 14, dpi = 100, limitsize = FALSE)
"plots/desktop/passyds_1080desktop.png" %>% ggsave(passyds_plot_desktop_mobile, width = 14, height = 10, dpi = 100, limitsize = FALSE)
"plots/mobile/pass.att_1440mobile.png" %>% ggsave(pass.att_plot_desktop_mobile, width = 14, height = 18, dpi = 100, limitsize = FALSE)
"plots/mobile/pass.att_1080mobile.png" %>% ggsave(pass.att_plot_desktop_mobile, width = 10, height = 14, dpi = 100, limitsize = FALSE)
"plots/desktop/pass.att_1080desktop.png" %>% ggsave(pass.att_plot_desktop_mobile, width = 14, height = 10, dpi = 100, limitsize = FALSE)
gg.targets %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .75)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team), stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets") + desktop_facet
gg.targets %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .66)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team), stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets") + desktop_facet
targets_plot <- gg.targets %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .66)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team), stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets")
targetsplot_mobile <- targets_plot + mobile_facet
targetsplot_desktop <- targets_plot + desktop_facet
"plots/mobile/targets_1080mobile.png" %>% ggsave(targetsplot_mobile, width = 10, height = 19, dpi = 100, limitsize = FALSE)
"plots/mobile/targets_1440mobile.png" %>% ggsave(targetsplot_mobile, width = 14, height = 25, dpi = 100, limitsize = FALSE)
"plots/desktop/targets_1440desktop.png" %>% ggsave(targetsplot_desktop, width = 25, height = 14, dpi = 100, limitsize = FALSE)
"plots/desktop/targets_1080desktop.png" %>% ggsave(targetsplot_desktop, width = 19, height = 10, dpi = 100, limitsize = FALSE)
gg.targets %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .66)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team, color = Team), stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets") + desktop_facet
gg.targets %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .66)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team, color = Black), stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets") + desktop_facet
gg.targets %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .66)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team, color = "Black"), stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets") + desktop_facet
targets_plot <- gg.targets %>%
ggplot() +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$primary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, .66)) +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets,  fill = Team, color = Team), stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), stat ="identity") +
## scale_x_reordered() +
##scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = "2019 targets by team",
subtitle = paste("Minimum", gg.targets_minimum, "targets", sep = " ")) +
xlab("Targeted players") +
ylab("Targets")
targetsplot_mobile <- targets_plot + mobile_facet
targetsplot_desktop <- targets_plot + desktop_facet
"plots/mobile/targets_1080mobile.png" %>% ggsave(targetsplot_mobile, width = 10, height = 19, dpi = 100, limitsize = FALSE)
"plots/mobile/targets_1440mobile.png" %>% ggsave(targetsplot_mobile, width = 14, height = 25, dpi = 100, limitsize = FALSE)
"plots/desktop/targets_1440desktop.png" %>% ggsave(targetsplot_desktop, width = 25, height = 14, dpi = 100, limitsize = FALSE)
"plots/desktop/targets_1080desktop.png" %>% ggsave(targetsplot_desktop, width = 19, height = 10, dpi = 100, limitsize = FALSE)
