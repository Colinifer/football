geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -5, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 2, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 7, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -5, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 7, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -6, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 7, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -6, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 8, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
targetsplot <- gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -8, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 8, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x))
desktop_facet <- facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
mobile_facet <- facet_wrap( ~ Team, ncol = 32/8, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
targetsplot <- gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -8, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 8, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x))
desktop_facet <- facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
desktop_facet <- ggplot() +
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
mobile_facet <- ggplot() +
facet_wrap( ~ Team, ncol = 32/8, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
targetsplot + desktop_facet
ggplot(targetsplot + desktop_facet)
gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -8, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 8, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x))
gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -8, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 8, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -8, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 8, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
# facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
gg.min <- 25 # What is the minimum receiving yards for the sample?
gg.targets <- x.players %>%
filter(targets > gg.min) %>%
arrange(desc(targets)) %>%
arrange(Team)
# mutate(name = reorder_within(name, targets, Team, sep = "")) %>%
# Mobile
targetsplot_mobile <- gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -8, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 8, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
facet_wrap( ~ Team, ncol = 32/8, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
f.gg_file <- paste("plots/mobile/", u.year, "targets_1440mobile.png", sep = "")
ggsave(f.gg_file, targetsplot_mobile, width = 14, height = 25, dpi = 100, limitsize = FALSE)
f.gg_file <- paste("plots/mobile/", u.year, "targets_1080mobile.png", sep = "")
ggsave(f.gg_file, targetsplot_mobile, width = 10, height = 19, dpi = 100, limitsize = FALSE)
# Desktop
targetsplot_desktop <- gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -8, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 8, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
# facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
f.gg_file <- paste("plots/desktop/", u.year, "targets_1440desktop.png", sep = "")
ggsave(f.gg_file , targetsplot_desktop, width = 25, height = 14, dpi = 100, limitsize = FALSE)
f.gg_file <- paste("plots/desktop/", u.year, "targets_1080desktop.png", sep = "")
ggsave(f.gg_file, targetsplot_desktop, width = 19, height = 10, dpi = 100, limitsize = FALSE)
targetsplot_desktop <- gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -8, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 8, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
f.gg_file <- paste("plots/desktop/", u.year, "targets_1440desktop.png", sep = "")
ggsave(f.gg_file , targetsplot_desktop, width = 25, height = 14, dpi = 100, limitsize = FALSE)
f.gg_file <- paste("plots/desktop/", u.year, "targets_1080desktop.png", sep = "")
ggsave(f.gg_file, targetsplot_desktop, width = 19, height = 10, dpi = 100, limitsize = FALSE)
targetsplot_mobile <- gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -10, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 10, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
facet_wrap( ~ Team, ncol = 32/8, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
f.gg_file <- paste("plots/mobile/", u.year, "targets_1440mobile.png", sep = "")
ggsave(f.gg_file, targetsplot_mobile, width = 14, height = 25, dpi = 100, limitsize = FALSE)
f.gg_file <- paste("plots/mobile/", u.year, "targets_1080mobile.png", sep = "")
ggsave(f.gg_file, targetsplot_mobile, width = 10, height = 19, dpi = 100, limitsize = FALSE)
# Desktop
targetsplot_desktop <- gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -10, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 10, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
f.gg_file <- paste("plots/desktop/", u.year, "targets_1440desktop.png", sep = "")
ggsave(f.gg_file , targetsplot_desktop, width = 25, height = 14, dpi = 100, limitsize = FALSE)
f.gg_file <- paste("plots/desktop/", u.year, "targets_1080desktop.png", sep = "")
ggsave(f.gg_file, targetsplot_desktop, width = 19, height = 10, dpi = 100, limitsize = FALSE)
gg.min <- 25 # What is the minimum receiving yards for the sample?
gg.targets <- x.players %>%
filter(recept > gg.min) %>%
arrange(desc(targets)) %>%
arrange(Team)
# mutate(name = reorder_within(name, targets, Team, sep = "")) %>%
# Mobile
targetsplot_mobile <- gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -10, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 10, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
facet_wrap( ~ Team, ncol = 32/8, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
f.gg_file <- paste("plots/mobile/", u.year, "targets_1440mobile.png", sep = "")
ggsave(f.gg_file, targetsplot_mobile, width = 14, height = 25, dpi = 100, limitsize = FALSE)
f.gg_file <- paste("plots/mobile/", u.year, "targets_1080mobile.png", sep = "")
ggsave(f.gg_file, targetsplot_mobile, width = 10, height = 19, dpi = 100, limitsize = FALSE)
# Desktop
targetsplot_desktop <- gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -10, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 10, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
f.gg_file <- paste("plots/desktop/", u.year, "targets_1440desktop.png", sep = "")
ggsave(f.gg_file , targetsplot_desktop, width = 25, height = 14, dpi = 100, limitsize = FALSE)
f.gg_file <- paste("plots/desktop/", u.year, "targets_1080desktop.png", sep = "")
ggsave(f.gg_file, targetsplot_desktop, width = 19, height = 10, dpi = 100, limitsize = FALSE)
View(gg.targets)
gg.min <- 25 # What is the minimum receiving yards for the sample?
gg.targets <- x.players %>%
filter(targets > gg.min) %>%
arrange(desc(targets)) %>%
arrange(Team)
targetsplot_desktop <- gg.targets %>%
ggplot() +
#ggplot(aes(x=reorder_within(name, -targets, Team), fill = "transparent", colour = Team)) +
theme_bw() +
scale_color_manual(values = nfl_teamcolors$secondary) +
scale_fill_manual(values = alpha(nfl_teamcolors$primary, 1)) +
# geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team), alpha = 1.0, stat ="identity") +
geom_bar(aes(x=reorder_within(name, -recept, Team), y=recept,  fill = Team), size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -recept, Team), y=recept, label = recept), nudge_y = -10, color = "white") +
geom_bar(aes(x=reorder_within(name, -targets, Team), y=targets, fill = Team, color = Team),  alpha = .01, size = 1, stat ="identity") +
geom_text(aes(x=reorder_within(name, -targets, Team), y=targets, label = targets), nudge_y = 10, color = "black") +
#geom_bar(aes(y=targets,  colour = Team, fill = "white"), data = filter(x.players, targets > 20), alpha = 1.0, stat ="identity") +
#geom_bar(aes(y=recept,  fill = Team), stat ="identity") +
# scale_x_reordered() +
#scale_color_teams(2, guide = FALSE) +
scale_x_discrete(labels = function(x) gsub("__.+$", "", x)) +
facet_wrap( ~ Team, ncol = 32/4, scales = "free_x") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position="none") +
labs(title = paste(u.year, "targets by team", sep = " "),
subtitle = "Minimum 20 targets") +
xlab("Targeted players") +
ylab("Targets")
f.gg_file <- paste("plots/desktop/", u.year, "targets_1440desktop.png", sep = "")
ggsave(f.gg_file , targetsplot_desktop, width = 25, height = 14, dpi = 100, limitsize = FALSE)
View(x.players)
pkgs <- c(
"devtools",
"tidyverse",
"DBI",
"odbc",
"RMariaDB",
"readr",
"pander",
"furrr",
"na.tools",
"ggimage",
"teamcolors",
"glue",
"dplyr",
"tictoc",
"animation",
"gt",
"DT",
"ggthemes",
"ggforce",
"ggridges",
"ggrepel",
"ggbeeswarm",
"extrafont",
"tidytext",
"RCurl"
)
installed_packages <- pkgs %in%
rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(pkgs[!installed_packages])
}
lapply(pkgs, library, character.only = TRUE)
# library("nflscrapR") # doesn't work anymore
library("nflfastR")
# library("ffscrapr")
##reset
setwd("~/")
gid <- paste(getwd())
gid
device <- ""
if (gid == "/Volumes/HDD/Users/colinwelsh") {
## Maverick - MBP
setwd("~/Documents/dev/football")
device <- "Maverick (MBP)"
} else if (gid == "/Users/ColinWelsh") {
## Goose - iMac
setwd("~/Documents/dev/football")
device <- "Goose (iMac)"
} else if (gid == "/home/rstudio-user") {
## RStudio Cloud
setwd("/cloud/project")
device <- "RStudio Cloud"
}
print(paste(device, "is ready for some football", sep = " "))
rm(gid)
# Create standard objects -------------------------------------------------
source("con.R") # set condition based on device to update local vs remote connections to document
dbListTables(con)
dbListObjects(con)
dbListFields(con, "pbp")
dbListFields(con, "schedule")
source("con.R")
source("con.R")
source("con.R")
source("con.R")
dbListTables(con)
dbListObjects(con)
dbListFields(con, "pbp")
dbListObjects(con)
dbListTables(con)
nrow(dbListTables(con)
)
count(dbListTables(con))
class(dbListTables(con))
?dbListTables
